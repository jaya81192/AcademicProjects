import java.io.BufferedReader;
import java.io.BufferedWriter;
import java.io.File;
import java.io.FileReader;
import java.io.FileWriter;
import java.io.IOException;
import java.util.HashMap;
import java.util.HashSet;


public class computeunigramfeatureset {
	public static void main(String[] args) throws IOException {
		HashSet<String> set = new HashSet<String>();
		HashMap<String,String> Labelmap = new HashMap<String,String>();
		FileReader reader = new FileReader("C:\\Users\\venky\\Desktop\\Data Mining\\300unigramfeatures.csv");
		BufferedReader bufferreader = new BufferedReader(reader);
		FileWriter writer = new FileWriter("C:\\Users\\venky\\Desktop\\Data Mining\\Featuresetunigramtest.csv");
		BufferedWriter bufferwriter = new BufferedWriter(writer);
		File folder = new File("C:\\Users\\venky\\Desktop\\Data Mining\\Unigramstest");
		File[] listOfFiles = folder.listFiles();
		String line;
		
		while((line = bufferreader.readLine()) != null){
			for(String uni : line.toLowerCase().split(","))
					set.add(uni);
		}
		bufferreader.close();
		
/*		FileReader Reader = new FileReader("C:\\Users\\venky\\Desktop\\Data Mining\\trainLabels.csv");
		BufferedReader buffreader = new BufferedReader(Reader);
		while((line = buffreader.readLine()) != null){
			String[] part = line.split(",");
			if(part.length==2)
				Labelmap.put(part[0], part[1]);
		}
		buffreader.close();*/
		System.out.println(Labelmap.size());		
		bufferwriter.append("filename"+",");
		for(String Unigram : set)
			bufferwriter.append(Unigram+",");
		bufferwriter.append("ClassLabel");
		bufferwriter.append("\n");
		int j=1;
		for(File file : listOfFiles){
			if(file.isFile()){
				System.out.println(j++);
				FileReader filereader = new FileReader("C:\\Users\\venky\\Desktop\\Data Mining\\Unigramstest\\"+file.getName());
				BufferedReader bufferfilereader = new BufferedReader(filereader);
				HashMap<String,String> localmap=new HashMap<String,String>();
				while((line = bufferfilereader.readLine()) != null){
					String[] Part=line.split(",");
					if(Part.length==2)
						localmap.put(Part[0], Part[1]);
				}
				bufferfilereader.close();
				bufferwriter.append(file.getName()+",");
				for(String UNigram : set){
					if(localmap.get(UNigram)!=null)
						bufferwriter.append(localmap.get(UNigram)+",");
					else
						bufferwriter.append("0"+",");
				}
	//			bufferwriter.append(Labelmap.get(file.getName().substring(0, file.getName().length()-4)));
				bufferwriter.append("\n");
			}
		}
		bufferwriter.close();
	}
}
