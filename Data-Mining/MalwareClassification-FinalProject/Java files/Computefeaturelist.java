import java.io.BufferedReader;
import java.io.BufferedWriter;
import java.io.File;
import java.io.FileReader;
import java.io.FileWriter;
import java.io.IOException;
import java.util.HashMap;
import java.util.HashSet;


public class Computefeaturelist {

	public static void pushmap(HashMap<String,Integer> map, String s){
		if(map.get(s)==null)
			map.put(s, 1);
		else
			map.put(s, map.get(s)+1);
	}

	public static void main(String[] args) throws IOException {
		HashSet<String> set = new HashSet<String>();
		File folder = new File("C:\\Users\\venky\\Desktop\\Data Mining\\Frequency");
		String finalfilename="Bigramlist.csv";
		FileWriter writer = new FileWriter("C:\\Users\\venky\\Desktop\\Data Mining\\"+finalfilename);
		BufferedWriter bufferwriter = new BufferedWriter(writer);
		File[] listOfFiles = folder.listFiles();
		for (File file : listOfFiles) {
		    if (file.isFile()) {
		    	String filename=file.getName();
				FileReader inputFile = new FileReader("C:\\Users\\venky\\Desktop\\Data Mining\\Frequency\\"+filename);
		        BufferedReader bufferReader = new BufferedReader(inputFile);
		        String line;
		        while ((line = bufferReader.readLine()) != null)   {
		        	String[] Part = line.split("\\t");
				    if(Part.length>2){
				        String Bigram=Part[0]+"|"+Part[1];
				        set.add(Bigram);
				    }
		        }
		    }
		}
		System.out.println(set.size());
		for(String bigram : set.toString().split(", ")){
			bufferwriter.append(bigram.toString()+"\t");
		}
		bufferwriter.close();
	}

}
